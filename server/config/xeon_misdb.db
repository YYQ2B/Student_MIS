/*为学生表字段增加了约束*/
/*完整数据库学生表，已验证*/
drop database xeon_misdb;

create database xeon_misdb;

use xeon_misdb;

/*创建民族表*/
create table xeon_nationlities(
nationid varchar(9) primary key,
nation varchar(9)
);

/*创建学院表*/
create table xeon_institute(
instituteid char(2) primary key,
institute varchar(20)
);

/*创建专业表*/
create table xeon_major(
majorid char(4) primary key,
major varchar(20),
instituteid char(2),
foreign key(instituteid) references xeon_institute(instituteid)
);

/*创建班级表*/
create table xeon_class(
classid char(6) primary key,
majorid char(4),
foreign key(majorid) references xeon_major(majorid)
);

/*生源地表*/
create table xeon_origin(
originid varchar(10) primary key,
origin varchar(20)
);

/*创建省表*/
create table xeon_location_province(
location_provinceid char(2) primary key,
location_province varchar(10)
);

/*创建市表*/
create table xeon_location_city(
location_cityid char(4) primary key,
location_city varchar(10),
location_provinceid char(2),
foreign key(location_provinceid) references xeon_location_province(location_provinceid)
);

/*创建县表*/
create table xeon_location_county(
location_countyid char(6) primary key,
location_county varchar(10),
location_cityid char(4),
foreign key(location_cityid) references xeon_location_city(location_cityid)
);

/*创建公寓表*/
create table xeon_dormbuilding(
dormbuildingid char(2) primary key,
dormbuilding varchar(10)
);

/*创建寝室表*/
create table xeon_dorm(
dormid char(4) primary key,
dorm varchar(10),
dormbuildingid char(2),
foreign key(dormbuildingid) references xeon_dormbuilding(dormbuildingid)
);

/*辅导员表*/
create table xeon_instructor_info(
instructorid varchar(10) primary key,
instructor_name varchar(10),
classid char(6),
foreign key(classid) references xeon_class(classid)
);

/*创建学生表*/
create table xeon_student_info(
stuid varchar(10) primary key,	
name varchar(30) not null, /*姓名长度改为30(15字)*/
sex char(2) check(sex='男' or sex='女' ),	/*增加约束*/
nationid varchar(9) ,
classid char(6) ,
grade smallint check(grade >1992 and grade<2113),/*年级改为短整形增加约束*/
identify varchar(18) not null,
birth date not null,	/*生日改为日期*/
govface varchar(10) check(govface='党员' or govface='团员' or govface='预备党员'),/*增加约束*/
tel varchar(11) not null,	/*电话长度改为11*/
originid varchar(10) ,
location_countyid char(6) ,
family varchar(20) not null,	/*增加非空*/
registerstatus varchar(10) not null,
ifpoor char(1) check(ifpoor='0' or ifpoor='1'),	/*长度改为1增加约束*/
ifcountryloan char(1) check(ifcountryloan='0' or ifcountryloan='1'),/*长度改为1增加约束*/
iforigin char(1) check(iforigin='0' or iforigin='1'),	/*长度改为1增加约束*/
ifcommerial_insurance char(1) check(ifcommerial_insurance='0' or ifcommerial_insurance='1') ,/*长度改为1增加约束*/
ifmedical_insurance char(1) check(ifmedical_insurance='0' or ifmedical_insurance='1'),/*长度改为1增加约束*/
dormid char(4),
foreign key(nationid) references xeon_nationlities(nationid),
foreign key(classid) references xeon_class(classid),
foreign key(originid) references xeon_origin(originid),
foreign key(location_countyid) references xeon_location_county(location_countyid),
foreign key(dormid) references xeon_dorm(dormid) 
);
